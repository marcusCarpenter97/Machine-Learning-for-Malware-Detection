
from sklearn.ensemble import RandomForestClassifier as RFC
from scikitClassifier import ScikitClassifier
from sklearn import tree
import graphviz


class RandomForestClassifier(ScikitClassifier):

    def __init__(self, num_of_trees=10):
        ScikitClassifier.__init__(self, RFC(num_of_trees))

    def export_as_pdf(self, feature_names, label_names):

        for tree_index, tree_in_forest in enumerate(self.classifier.estimators_):
            dot_data = tree.export_graphviz(tree_in_forest, out_file=None,
                                            feature_names=feature_names,
                                            class_names=label_names,
                                            filled=True, rounded=True,
                                            special_characters=True)

            graph = graphviz.Source(dot_data)
            graph.render(filename=f"Tree{tree_index}_in_forest", directory=self.dir_for_saving_images)
