
from sklearn import tree
import graphviz


class DecisionTreeClassifier:

    def __init__(self):
        self.classifier = tree.DecisionTreeClassifier()
        self.tree_model = None

    def train_model(self, training_data, training_labels):
        self.tree_model = self.classifier.fit(training_data, training_labels)

    def predict(self, testing_data):
        return self.classifier.predict(testing_data)

    def calculate_accuracy(self, testing_data, testing_labels):
        return self.classifier.score(testing_data, testing_labels)

    def export_tree_as_pdf(self, feature_names, label_names):
        dot_data = tree.export_graphviz(self.classifier, out_file=None,
                                        feature_names=feature_names,
                                        class_names=label_names,
                                        filled=True, rounded=True,
                                        special_characters=True)

        graph = graphviz.Source(dot_data)
        graph.render(filename="treeTest", directory="/home/marcus/PycharmProjects/Final_Project/")
