
from dataset import Dataset
from decisionTreeClassifier import DecisionTreeClassifier
from sklearn.metrics import confusion_matrix

# Prepare data
data = Dataset()
data.load_data()

training_data, testing_data, training_labels, testing_labels = data.partition_data(0.33)

# Create model
tree_classifier = DecisionTreeClassifier()
tree_classifier.train_model(training_data, training_labels)

# Predict
predicted_labels = tree_classifier.predict(testing_data)
accuracy = tree_classifier.calculate_accuracy(testing_data, testing_labels)

# Create pdf of decision tree
tree_classifier.export_tree_as_pdf(data.feature_names, data.label_names)

print(f"Accuracy: {accuracy}")

# Calculate confusion matrix
conf_matrix = confusion_matrix(testing_labels, predicted_labels)
print(f"Confusion Matrix\n        Benign | Malware\nBenign  {conf_matrix[0][0]}    | {conf_matrix[0][1]}\n"
      f"Malware {conf_matrix[1][0]}      | {conf_matrix[1][1]}")
