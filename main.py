
from dataset import Dataset
from sklearn import tree
from sklearn.model_selection import train_test_split
import graphviz

data = Dataset()

data.load_data()

training_data, testing_data, training_labels, testing_labels = train_test_split(data.features, data.labels, test_size=0.33)

classifier = tree.DecisionTreeClassifier()
decision_tree = classifier.fit(training_data, training_labels)

ans = classifier.score(testing_data, testing_labels)

dot_data = tree.export_graphviz(decision_tree, out_file=None,
                                feature_names=data.feature_names,
                                class_names=data.label_names,
                                filled=True, rounded=True,
                                special_characters=True)

graph = graphviz.Source(dot_data)
path = graph.render(filename="treeTest", directory="/home/marcus/PycharmProjects/Final_Project/")

print(ans)
